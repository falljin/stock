<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>KRX íŒ¨í„´ ìŠ¤ìº” ížˆìŠ¤í† ë¦¬</title>

<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
    }

    h2 {
        margin-bottom: 10px;
    }

    h3 {
        margin-top: 40px;
        margin-bottom: 10px;
        color: #333;
    }

    table {
        border-collapse: collapse;
        width: 100%;
        margin-bottom: 20px;
    }

    th, td {
        border: 1px solid #ccc;
        padding: 6px 10px;
        text-align: center;
    }

    th {
        background-color: #f2f2f2;
    }
</style>
</head>
<body>

<h2>KRX íŒ¨í„´ ìŠ¤ìº” ê²°ê³¼ ížˆìŠ¤í† ë¦¬</h2>
<div id="tables"></div>

<script>
const csvUrl = "pattern_latest.csv";

/* ðŸŽ¨ ê°€ë…ì„± ì¢‹ì€ ê³ ëŒ€ë¹„ ìƒ‰ìƒ íŒ”ë ˆíŠ¸ */
const COLORS = [
    "#FFCDD2", "#F8BBD0", "#E1BEE7", "#D1C4E9",
    "#C5CAE9", "#BBDEFB", "#B3E5FC", "#B2EBF2",
    "#B2DFDB", "#C8E6C9", "#DCEDC8", "#F0F4C3",
    "#FFF9C4", "#FFE0B2", "#FFCCBC", "#D7CCC8"
];

fetch(csvUrl)
    .then(res => res.text())
    .then(text => {
        const lines = text.trim().split("\n");
        const container = document.getElementById("tables");

        let currentDate = null;
        let header = [];
        let table, tbody;

        /* ðŸ”‘ ì¢…ëª©ë³„ ìƒ‰ìƒ ê³ ì • ë§¤í•‘ */
        const colorMap = {};
        let colorIndex = 0;

        lines.forEach(line => {
            const cells = line.split(",");

            // ðŸ“… ë‚ ì§œ í–‰ (YYYY-MM-DD)
            if (cells.length === 1 && /^\d{4}-\d{2}-\d{2}$/.test(cells[0])) {
                currentDate = cells[0];

                // ë‚ ì§œ ì œëª©
                const h3 = document.createElement("h3");
                h3.textContent = currentDate;
                container.appendChild(h3);

                // ìƒˆ í…Œì´ë¸” ìƒì„±
                table = document.createElement("table");
                tbody = document.createElement("tbody");
                table.appendChild(tbody);
                container.appendChild(table);

                header = [];
                return;
            }

            // ðŸ“Œ í—¤ë” í–‰
            if (header.length === 0) {
                header = cells;
                const thead = document.createElement("thead");
                const tr = document.createElement("tr");

                header.forEach(h => {
                    const th = document.createElement("th");
                    th.textContent = h;
                    tr.appendChild(th);
                });

                thead.appendChild(tr);
                table.insertBefore(thead, tbody);
                return;
            }

            // ðŸ“Š ë°ì´í„° í–‰
            const name = cells[0];

            if (!colorMap[name]) {
                colorMap[name] = COLORS[colorIndex % COLORS.length];
                colorIndex++;
            }

            const tr = document.createElement("tr");
            tr.style.backgroundColor = colorMap[name];

            cells.forEach(cell => {
                const td = document.createElement("td");
                td.textContent = cell;
                tr.appendChild(td);
            });

            tbody.appendChild(tr);
        });
    });
</script>

</body>
</html>
