<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>KRX íŒ¨í„´ ìŠ¤ìº” íˆìŠ¤í† ë¦¬</title>

<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
        display: flex;
        justify-content: center;
        background-color: #f9f9f9;
    }

    #tables {
        width: 90%;        /* í™”ë©´ ëŒ€ë¹„ 90% í­ */
        max-width: 1000px; /* ìµœëŒ€ í­ ì œí•œ */
    }

    h2 {
        text-align: center;
        margin-bottom: 20px;
    }

    h3 {
        margin-top: 40px;
        margin-bottom: 10px;
        color: #333;
    }

    table {
        border-collapse: collapse;
        width: 100%;           /* div í­ 100% */
        margin-bottom: 20px;
        table-layout: fixed;   /* ì—´ ë„ˆë¹„ ê· ë“± */
        word-wrap: break-word; /* ê¸´ í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆ */
        background-color: #fff;
        box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }

    th, td {
        border: 1px solid #ccc;
        padding: 6px 10px;
        text-align: center;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
        font-size: 14px;
    }

    th {
        background-color: #f2f2f2;
    }

    /* ëª¨ë°”ì¼ ëŒ€ì‘ */
    @media screen and (max-width: 600px) {
        #tables {
            width: 100%;
        }

        th, td {
            padding: 4px 6px;
            font-size: 12px;
        }
    }
</style>
</head>
<body>

<div id="tables">
    <h2>KRX íŒ¨í„´ ìŠ¤ìº” ê²°ê³¼ íˆìŠ¤í† ë¦¬</h2>
</div>

<script>
const csvUrl = "https://falljin.github.io/stock/pattern_latest.csv";

/* ğŸ¨ ê³ ëŒ€ë¹„ ìƒ‰ìƒ íŒ”ë ˆíŠ¸ (ì¢…ëª©ë³„ ê³ ì •) */
const COLORS = [
    "#FFCDD2", "#F8BBD0", "#E1BEE7", "#D1C4E9",
    "#C5CAE9", "#BBDEFB", "#B3E5FC", "#B2EBF2",
    "#B2DFDB", "#C8E6C9", "#DCEDC8", "#FFF9C4",
    "#FFE0B2", "#FFCCBC"
];

fetch(csvUrl)
    .then(res => res.text())
    .then(text => {
        // ğŸ”‘ CRLF ë¬¸ì œ í•´ê²°
        const lines = text.trim().replace(/\r/g, "").split("\n");
        const container = document.getElementById("tables");

        let table, tbody;
        let headerReady = false;

        const colorMap = {};
        let colorIndex = 0;

        lines.forEach(line => {
            if (!line.trim()) return;

            const cells = line.split(",");

            // ë‚ ì§œ í–‰
            if (cells.length === 1 && /^\d{4}-\d{2}-\d{2}$/.test(cells[0])) {
                const h3 = document.createElement("h3");
                h3.textContent = cells[0];
                container.appendChild(h3);

                table = document.createElement("table");
                tbody = document.createElement("tbody");
                table.appendChild(tbody);
                container.appendChild(table);

                headerReady = false;
                return;
            }

            // í—¤ë”
            if (!headerReady) {
                const thead = document.createElement("thead");
                const tr = document.createElement("tr");

                cells.forEach(h => {
                    const th = document.createElement("th");
                    th.textContent = h;
                    tr.appendChild(th);
                });

                thead.appendChild(tr);
                table.insertBefore(thead, tbody);
                headerReady = true;
                return;
            }

            // ë°ì´í„° í–‰
            const name = cells[0];
            if (!colorMap[name]) {
                colorMap[name] = COLORS[colorIndex % COLORS.length];
                colorIndex++;
            }

            const tr = document.createElement("tr");
            tr.style.backgroundColor = colorMap[name];

            cells.forEach(cell => {
                const td = document.createElement("td");
                td.textContent = cell;
                tr.appendChild(td);
            });

            tbody.appendChild(tr);
        });
    });

const rows = csv
  .replace(/\r/g, '')
  .split('\n')
  .filter(line => line.trim().length > 0);

</script>

</body>
</html>
